2025-11-03 10:23:03 - Use pytorch device_name: cuda:0
2025-11-03 10:23:03 - Load pretrained SentenceTransformer: /home/aiml_user/vishnu/sptar_rl/zhiyuan/retriever/dpr/train/output/llama_7b_500_fixed_v3_best_llama_prompt_2_filtered_70_filtered_50/50/bert-base-uncased-v1-fiqa
2025-11-03 10:23:04 - Loading Corpus...
2025-11-03 10:23:04 - Loaded 57638 TEST Documents.
2025-11-03 10:23:04 - Doc Example: {'text': "I'm not saying I don't like the idea of on-the-job training too, but you can't expect the company to do that. Training workers is not their job - they're building software. Perhaps educational systems in the U.S. (or their students) should worry a little about getting marketable skills in exchange for their massive investment in education, rather than getting out with thousands in student debt and then complaining that they aren't qualified to do anything.", 'title': ''}
2025-11-03 10:23:04 - Loading Queries...
2025-11-03 10:23:04 - Loaded 648 TEST Queries.
2025-11-03 10:23:04 - Query Example: How to deposit a cheque issued to an associate in my business into my business account?
2025-11-03 10:23:04 - Encoding Queries...
2025-11-03 10:23:06 - Sorting Corpus by document length (Longest first)...
2025-11-03 10:23:06 - Encoding Corpus in batches... Warning: This might take a while!
2025-11-03 10:23:06 - Scoring Function: Cosine Similarity (cos_sim)
2025-11-03 10:23:06 - Encoding Batch 1/1...
2025-11-03 10:30:08 - Retriever evaluation for dataset fiqa
2025-11-03 10:30:08 - For evaluation, we ignore identical query and document ids (default), please explicitly set ``ignore_identical_ids=False`` to ignore this.
2025-11-03 10:30:08 - 

2025-11-03 10:30:08 - NDCG@1: 0.1034
2025-11-03 10:30:08 - NDCG@3: 0.1030
2025-11-03 10:30:08 - NDCG@5: 0.1083
2025-11-03 10:30:08 - NDCG@10: 0.1221
2025-11-03 10:30:08 - NDCG@100: 0.1745
2025-11-03 10:30:08 - NDCG@300: 0.2005
2025-11-03 10:30:08 - NDCG@500: 0.2127
2025-11-03 10:30:08 - NDCG@1000: 0.2259
2025-11-03 10:30:08 - 

2025-11-03 10:30:08 - MAP@1: 0.0481
2025-11-03 10:30:08 - MAP@3: 0.0735
2025-11-03 10:30:08 - MAP@5: 0.0802
2025-11-03 10:30:08 - MAP@10: 0.0871
2025-11-03 10:30:08 - MAP@100: 0.0968
2025-11-03 10:30:08 - MAP@300: 0.0983
2025-11-03 10:30:08 - MAP@500: 0.0987
2025-11-03 10:30:08 - MAP@1000: 0.0990
2025-11-03 10:30:08 - 

2025-11-03 10:30:08 - Recall@1: 0.0481
2025-11-03 10:30:08 - Recall@3: 0.0963
2025-11-03 10:30:08 - Recall@5: 0.1183
2025-11-03 10:30:08 - Recall@10: 0.1581
2025-11-03 10:30:08 - Recall@100: 0.3709
2025-11-03 10:30:08 - Recall@300: 0.5199
2025-11-03 10:30:08 - Recall@500: 0.5978
2025-11-03 10:30:08 - Recall@1000: 0.6929
2025-11-03 10:30:08 - 

2025-11-03 10:30:08 - P@1: 0.1034
2025-11-03 10:30:08 - P@3: 0.0715
2025-11-03 10:30:08 - P@5: 0.0534
2025-11-03 10:30:08 - P@10: 0.0366
2025-11-03 10:30:08 - P@100: 0.0090
2025-11-03 10:30:08 - P@300: 0.0043
2025-11-03 10:30:08 - P@500: 0.0030
2025-11-03 10:30:08 - P@1000: 0.0018
2025-11-03 10:30:08 - 

2025-11-03 10:30:09 - MRR@1: 0.1034
2025-11-03 10:30:09 - MRR@3: 0.1386
2025-11-03 10:30:09 - MRR@5: 0.1455
2025-11-03 10:30:09 - MRR@10: 0.1545
2025-11-03 10:30:09 - MRR@100: 0.1638
2025-11-03 10:30:09 - MRR@300: 0.1648
2025-11-03 10:30:09 - MRR@500: 0.1650
2025-11-03 10:30:09 - MRR@1000: 0.1651
2025-11-03 10:30:09 - 

2025-11-03 10:30:09 - NDCG@1: 0.1034
2025-11-03 10:30:09 - NDCG@3: 0.1030
2025-11-03 10:30:09 - NDCG@5: 0.1083
2025-11-03 10:30:09 - NDCG@10: 0.1221
2025-11-03 10:30:09 - NDCG@100: 0.1745
2025-11-03 10:30:09 - NDCG@300: 0.2005
2025-11-03 10:30:09 - NDCG@500: 0.2127
2025-11-03 10:30:09 - NDCG@1000: 0.2259
2025-11-03 10:30:09 - 

2025-11-03 10:30:09 - MAP@1: 0.0481
2025-11-03 10:30:09 - MAP@3: 0.0735
2025-11-03 10:30:09 - MAP@5: 0.0802
2025-11-03 10:30:09 - MAP@10: 0.0871
2025-11-03 10:30:09 - MAP@100: 0.0968
2025-11-03 10:30:09 - MAP@300: 0.0983
2025-11-03 10:30:09 - MAP@500: 0.0987
2025-11-03 10:30:09 - MAP@1000: 0.0990
2025-11-03 10:30:09 - 

2025-11-03 10:30:09 - Recall@1: 0.0481
2025-11-03 10:30:09 - Recall@3: 0.0963
2025-11-03 10:30:09 - Recall@5: 0.1183
2025-11-03 10:30:09 - Recall@10: 0.1581
2025-11-03 10:30:09 - Recall@100: 0.3709
2025-11-03 10:30:09 - Recall@300: 0.5199
2025-11-03 10:30:09 - Recall@500: 0.5978
2025-11-03 10:30:09 - Recall@1000: 0.6929
